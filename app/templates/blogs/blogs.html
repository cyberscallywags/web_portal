{% extends "base.html" %}
{% block title %}Blogs - Cyber Scallywags{% endblock %}
{% block content %}

<style>
.blogs-hero {
  background: linear-gradient(135deg, #4006a7 0%, #0e6abd 50%, #CC0084 100%);
  padding: 4rem 0;
  position: relative;
  overflow: hidden;
  margin-bottom: 3rem;
}

.blogs-hero::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(193, 228, 21, 0.1) 1px, transparent 1px);
  background-size: 50px 50px;
  animation: moveGrid 20s linear infinite;
}

@keyframes moveGrid {
  0% { transform: translate(0, 0); }
  100% { transform: translate(50px, 50px); }
}

.blogs-hero-content {
  position: relative;
  z-index: 1;
  text-align: center;
}

.blogs-title {
  font-size: 3.5rem;
  font-weight: 900;
  background: linear-gradient(45deg, #C1E415, #00B1B3, white);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: fadeInDown 1s ease-out;
  margin-bottom: 1rem;
}

.blogs-tagline {
  font-size: 1.4rem;
  color: white;
  font-weight: 300;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
}

.filter-section {
  background: white;
  padding: 1.5rem 0;
  margin-bottom: 2rem;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
  border-radius: 16px;
}

.filter-section .form-control,
.filter-section .form-select {
  border: 2px solid #e6e6ef;
  border-radius: 12px;
  padding: 0.75rem 1rem;
  font-size: 1rem;
  transition: all 0.3s ease;
}

.filter-section .form-control:focus,
.filter-section .form-select:focus {
  border-color: #C1E415;
  box-shadow: 0 0 0 0.2rem rgba(193, 228, 21, 0.25);
}

.blog-card {
  background: white;
  border-radius: 20px;
  overflow: hidden;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  border-top: 5px solid transparent;
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
  position: relative;
  height: 100%;
  cursor: pointer;
}

.blog-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 5px;
  background: linear-gradient(90deg, #4006a7, #C1E415, #00B1B3, #CC0084);
  transition: all 0.3s ease;
}

.blog-card:hover {
  transform: translateY(-10px) scale(1.02);
  box-shadow: 0 15px 40px rgba(64, 6, 167, 0.2);
}

.blog-card:hover::before {
  height: 8px;
}

.blog-featured-image {
  width: 100%;
  height: 220px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
  background: linear-gradient(135deg, #4006a7, #0e6abd);
  font-size: 4rem;
}

.blog-featured-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  transition: transform 0.3s ease;
}

.blog-card:hover .blog-featured-image img {
  transform: scale(1.1);
}

.blog-card-body {
  padding: 1.5rem;
}

.blog-title {
  color: #4006a7;
  font-size: 1.4rem;
  font-weight: 700;
  margin-bottom: 0.75rem;
  line-height: 1.3;
  transition: color 0.3s ease;
}

.blog-card:hover .blog-title {
  color: #CC0084;
}

.blog-excerpt {
  color: #666;
  font-size: 1rem;
  line-height: 1.6;
  margin-bottom: 1rem;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.blog-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 0.9rem;
  color: #888;
  margin-bottom: 1rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid #e6e6ef;
}

.author-info {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.author-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: linear-gradient(135deg, #C1E415, #00B1B3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #4006a7;
  font-weight: bold;
  font-size: 0.9rem;
}

.read-time {
  color: #4006a7;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.3rem;
}

.blog-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.blog-tag {
  background: linear-gradient(135deg, #4006a7, #CC0084);
  color: white;
  padding: 0.3rem 0.8rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 500;
  text-decoration: none;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.blog-tag:hover {
  background: white;
  color: #4006a7;
  border-color: #C1E415;
  transform: scale(1.05);
}

.pagination {
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 2rem;
}

.pagination .page-link {
  background: white;
  color: #4006a7;
  font-weight: 600;
  border-radius: 10px;
  margin: 0 0.25rem;
  transition: all 0.3s ease;
  border: 2px solid #e6e6ef;
}

.pagination .page-link:hover {
  background: #C1E415;
  color: #4006a7;
  transform: scale(1.1);
  border-color: #C1E415;
}

.pagination .page-item.active .page-link {
  background: linear-gradient(135deg, #4006a7, #CC0084);
  border-color: #4006a7;
  box-shadow: 0 4px 12px rgba(64, 6, 167, 0.3);
}

@media (max-width: 768px) {
  .blogs-title { font-size: 2.5rem; }
  .blogs-tagline { font-size: 1.1rem; }
  .blog-featured-image { height: 180px; font-size: 3rem; }
  .filter-section .row { flex-direction: column; }
}
</style>

<div class="blogs-hero">
  <div class="container">
    <div class="blogs-hero-content">
      <h1 class="blogs-title">üìù Cyber Scallywags Blog</h1>
      <p class="blogs-tagline">Stories, insights, and adventures from the pack that codes for the people</p>
    </div>
  </div>
</div>

<div class="container">
  <!-- Filter and Search Section -->
  <section class="filter-section">
    <div class="container">
      <div class="row g-3">
        <div class="col-md-8">
          <input type="text" id="searchInput" class="form-control" placeholder="üîç Search blog posts by title, content, or author...">
        </div>
        <div class="col-md-4">
          <select id="tagFilter" class="form-select">
            <option value="">All Categories</option>
            <option value="technology">Technology</option>
            <option value="community">Community</option>
            <option value="education">Education</option>
            <option value="open-source">Open Source</option>
            <option value="tutorials">Tutorials</option>
            <option value="events">Events</option>
          </select>
        </div>
      </div>
    </div>
  </section>

  <!-- Blog Posts Grid -->
  <section class="blog-posts py-4">
    <div class="row g-4" id="blogGrid">
      <!-- Blog posts will be loaded here via JavaScript -->
    </div>
  </section>

  <!-- Pagination -->
  <section class="pagination-section py-3">
    <nav aria-label="Blog pagination">
      <ul class="pagination justify-content-center" id="paginationNav">
        <!-- Pagination will be generated by JavaScript -->
      </ul>
    </nav>
  </section>
</div>

<script>
// Sample blog data - this would typically come from your API
const blogData = {
  "blogs": [
    {
      "id": 1,
      "title": "Building Communities Through Code: The Cyber Scallywags Way",
      "slug": "building-communities-through-code",
      "excerpt": "Discover how we're using technology to bring people together and create lasting change in our communities. From workshops to open-source projects, learn about our grassroots approach.",
      "content": "Full blog content goes here...",
      "author": {
        "name": "Colin Moore-Hill",
        "avatar": "/static/images/team/colin/pic.jpeg",
        "bio": "Founder & Community Lead"
      },
      "published_date": "2025-10-25T10:00:00Z",
      "featured_image": "/static/images/logo/CyberScallywags.png",
      "tags": ["community", "technology", "Civic Tech"],
      "read_time": "5 min read",
      "status": "published",
      "views": 12,
      "featured": true
    },
    {
      "id": 2,
      "title": "The DSF Companion: From Conversations to Connections",
      "slug": "the-dsf-companion",
      "excerpt": "Explore the DSF Companion, a platform designed to foster meaningful conversations and connections within the data community.",
      "content": "Full blog content goes here...",
      "author": {
        "name": "Kishion Layne",
        "avatar": "/static/images/authors/marcus.jpg",
        "bio": "Python Developer & Educator"
      },
      "published_date": "2025-10-20T14:30:00Z",
      "featured_image": "/static/images/logo/logo.png",
      "tags": ["tutorials", "python", "education"],
      "read_time": "8 min read",
      "status": "published",
      "views": 892,
      "featured": false
    },
    {
      "id": 3,
      "title": "Cyber Scallywags Hackathon 2026: Get ready to innovate!",
      "slug": "hackathon-2026-preview",
      "excerpt": "It will be an incredible weekend! Our annual hackathon brought together 120+ developers, designers, and innovators. Watch out for the amazing projects and see who wins.",
      "content": "Event: hackathon 2026 preview...",
      "author": {
        "name": "Fran Moore-Hill",
        "avatar": "/static/images/team/HairyCoo.jpeg",
        "bio": "Event Coordinator & UX Designer"
      },
      "published_date": "2025-10-15T09:00:00Z",
      "featured_image": "/static/images/logo/pogo.png",
      "tags": ["events", "community", "innovation"],
      "read_time": "6 min read",
      "status": "published",
      "views": 2103,
      "featured": true
    }
  ],
  "pagination": {
    "current_page": 1,
    "total_pages": 1,
    "total_posts": 3,
    "posts_per_page": 12
  }
};

// Blog functionality
class BlogManager {
  constructor() {
    this.blogs = blogData.blogs;
    this.filteredBlogs = [...this.blogs];
    this.currentPage = 1;
    this.postsPerPage = 6;
    this.init();
  }

  init() {
    this.renderBlogs();
    this.bindEvents();
  }

  bindEvents() {
    document.getElementById('searchInput').addEventListener('input', (e) => {
      this.filterBlogs(e.target.value, document.getElementById('tagFilter').value);
    });

    document.getElementById('tagFilter').addEventListener('change', (e) => {
      this.filterBlogs(document.getElementById('searchInput').value, e.target.value);
    });
  }

  filterBlogs(searchTerm = '', selectedTag = '') {
    this.filteredBlogs = this.blogs.filter(blog => {
      const matchesSearch = !searchTerm || 
        blog.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
        blog.excerpt.toLowerCase().includes(searchTerm.toLowerCase()) ||
        blog.author.name.toLowerCase().includes(searchTerm.toLowerCase());
      
      const matchesTag = !selectedTag || blog.tags.includes(selectedTag);
      
      return matchesSearch && matchesTag;
    });

    this.currentPage = 1;
    this.renderBlogs();
  }

  renderBlogs() {
    const startIndex = (this.currentPage - 1) * this.postsPerPage;
    const endIndex = startIndex + this.postsPerPage;
    const blogsToShow = this.filteredBlogs.slice(startIndex, endIndex);

    const blogGrid = document.getElementById('blogGrid');
    blogGrid.innerHTML = '';

    if (blogsToShow.length === 0) {
      blogGrid.innerHTML = '<div class="col-12 text-center"><p style="color: #C1E415; font-size: 1.2rem;">No blog posts found matching your criteria.</p></div>';
      return;
    }

    blogsToShow.forEach(blog => {
      const blogCard = this.createBlogCard(blog);
      blogGrid.appendChild(blogCard);
    });

    this.renderPagination();
  }

  createBlogCard(blog) {
    const col = document.createElement('div');
    col.className = 'col-12 col-md-6 col-lg-4';
    
    const publishedDate = new Date(blog.published_date);
    const authorInitials = blog.author.name.split(' ').map(n => n[0]).join('');

    col.innerHTML = `
      <article class="blog-card" onclick="window.location.href='/blog/${blog.slug}'">
        <div class="blog-featured-image">
          <img src="${blog.featured_image}" alt="${blog.title}">
        </div>
        <div class="blog-card-body">
          <h3 class="blog-title">${blog.title}</h3>
          <p class="blog-excerpt">${blog.excerpt}</p>
          <div class="blog-meta">
            <div class="author-info">
              <div class="author-avatar">${authorInitials}</div>
              <span>${blog.author.name}</span>
            </div>
            <span class="read-time">${blog.read_time}</span>
          </div>
          <div class="blog-tags">
            ${blog.tags.map(tag => `<span class="blog-tag">${tag}</span>`).join('')}
          </div>
        </div>
      </article>
    `;
    
    return col;
  }

  renderPagination() {
    const totalPages = Math.ceil(this.filteredBlogs.length / this.postsPerPage);
    const paginationNav = document.getElementById('paginationNav');
    
    if (totalPages <= 1) {
      paginationNav.innerHTML = '';
      return;
    }

    let paginationHTML = '';
    
    for (let i = 1; i <= totalPages; i++) {
      paginationHTML += `
        <li class="page-item ${i === this.currentPage ? 'active' : ''}">
          <button class="page-link" onclick="blogManager.goToPage(${i})" style="color: ${i === this.currentPage ? '#fff' : '#4006a7'}; background-color: ${i === this.currentPage ? '#4006a7' : '#fff'};">${i}</button>
        </li>
      `;
    }
    
    paginationNav.innerHTML = paginationHTML;
  }

  goToPage(page) {
    this.currentPage = page;
    this.renderBlogs();
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
}

// Initialize blog manager when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  window.blogManager = new BlogManager();
});
</script>

{% endblock %}